This	O
is	O
the	O
version	O
we	O
use	O
here	O
.	O
It	O
works	O
,	O
and	O
it	O
's	O
fairly	O
simple	O
.	O
It	O
's	O
the	O
same	O
idea	O
as	O
Jeff	O
's	O
but	O
I	O
think	O
it	O
's	O
a	O
little	O
clearer	O
because	O
it	O
separates	O
out	O
the	O
logic	O
for	O
subtracting	O
one	O
,	O
so	O
it	O
's	O
a	O
little	O
easier	O
to	O
understand	O
.	O
public	O
static	O
int	O
GetAge	O
(	O
this	O
dateOfBirth	O
,	O
DateTime	O
dateAsAt	O
)	O
{	O
return	O
dateAsAt.Year	O
-	O
dateOfBirth.Year	O
-	O
(	O
dateOfBirth.DayOfYear	O
dateAsAt.DayOfYear	O
?	O
0	O
:	O
1	O
)	O
;	O
}	O
You	O
could	O
expand	O
the	O
ternary	O
operator	O
to	O
make	O
it	O
even	O
clearer	O
,	O
if	O
you	O
think	O
that	O
sort	O
of	O
thing	O
is	O
unclear	O
.	O
Obviously	O
this	O
is	O
done	O
as	O
an	O
extension	O
method	O
on	O
DateTime	O
,	O
but	O
clearly	O
you	O
can	O
grab	O
that	O
one	O
line	O
of	O
code	O
that	O
does	O
the	O
work	O
and	O
put	O
it	O
anywhere	O
.	O
Here	O
we	O
have	O
another	O
overload	O
of	O
the	O
Extension	O
method	O
that	O
passes	O
in	O
,	O
just	O
for	O
completeness	O
.	O
