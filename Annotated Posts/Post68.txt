I	O
'm	O
trying	O
to	O
read	O
binary	O
data	O
using	O
C	O
#	O
.	O
I	O
have	O
all	O
information	O
about	O
the	O
layout	O
of	O
the	O
data	O
in	O
the	O
files	O
I	O
want	O
to	O
read	O
.	O
I	O
'm	O
able	O
to	O
read	O
the	O
data	O
``	O
chunk	O
by	O
chunk	O
''	O
,	O
i.e	O
.	O
getting	O
the	O
first	O
40	O
bytes	O
of	O
data	O
converting	O
it	O
to	O
a	O
string	O
,	O
get	O
the	O
next	O
40	O
bytes	O
,	O
...	O
Since	O
there	O
are	O
at	O
least	O
three	O
slighlty	O
different	O
version	O
of	O
the	O
data	O
,	O
I	O
would	O
like	O
to	O
read	O
the	O
data	O
directly	O
into	O
a	O
struct	O
.	O
It	O
just	O
feels	O
so	O
much	O
more	O
right	O
than	O
by	O
reading	O
it	O
``	O
line	O
by	O
line	O
''	O
.	O
I	O
have	O
tried	O
the	O
following	O
approach	O
but	O
to	O
no	O
avail	O
:	O
StructType	O
aStruct	O
;	O
int	O
count	O
=	O
Marshal.SizeOf	B-API
(	I-API
typeof	I-API
(	I-API
StructType	I-API
)	I-API
)	I-API
;	O
byte	O
[	O
]	O
readBuffer	O
=	O
new	O
byte	O
[	O
count	O
]	O
;	O
BinaryReader	O
reader	O
=	O
new	O
BinaryReader	O
(	O
stream	O
)	O
;	O
readBuffer	O
=	O
reader.ReadBytes	B-API
(	I-API
count	I-API
)	I-API
;	O
GCHandle	O
handle	O
=	O
GCHandle.Alloc	B-API
(	I-API
readBuffer	I-API
,	I-API
GCHandleType.Pinned	I-API
)	I-API
;	O
aStruct	O
=	O
(	O
StructType	O
)	O
Marshal.PtrToStructure	B-API
(	I-API
handle.AddrOfPinnedObject	I-API
(	I-API
)	I-API
,	I-API
typeof	I-API
(	I-API
StructType	I-API
)	I-API
)	I-API
;	O
handle.Free	B-API
(	I-API
)	I-API
;	O
The	O
stream	O
is	O
an	O
opened	O
FileStream	O
from	O
which	O
I	O
have	O
began	O
to	O
read	O
from	O
.	O
I	O
get	O
an	O
AccessViolationException	O
when	O
using	O
Marshal.PtrToStructure	O
.	O
The	O
stream	O
contains	O
more	O
information	O
than	O
I	O
'm	O
trying	O
to	O
read	O
since	O
I	O
'm	O
not	O
interested	O
in	O
data	O
at	O
the	O
end	O
of	O
the	O
file	O
.	O
The	O
struct	O
is	O
defined	O
like	O
:	O
[	O
StructLayout	O
(	O
LayoutKind.Explicit	O
)	O
]	O
struct	O
StructType	O
{	O
[	O
FieldOffset	O
(	O
0	O
)	O
]	O
public	O
string	O
FileDate	O
;	O
[	O
FieldOffset	O
(	O
8	O
)	O
]	O
public	O
string	O
FileTime	O
;	O
[	O
FieldOffset	O
(	O
16	O
)	O
]	O
public	O
int	O
Id1	O
;	O
[	O
FieldOffset	O
(	O
20	O
)	O
]	O
public	O
string	O
Id2	O
;	O
}	O
The	O
examples	O
code	O
is	O
changed	O
from	O
original	O
to	O
make	O
this	O
question	O
shorter	O
.	O
How	O
would	O
I	O
read	O
binary	O
data	O
from	O
a	O
file	O
into	O
a	O
struct	O
?	O
