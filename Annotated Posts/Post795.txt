Try	O
this	O
:	O
CREATE	B
function	B
)	B
returns	I
@	B
t	I
table	B
(	B
Word	B
not	B
null	B
,	I
Position	B
int	B
not	B
null	B
)	I
as	I
begin	B
declare	B
@	B
pos	I
int	B
,	I
@	B
lpos	I
int	B
,	I
@	B
item	I
,	B
@	B
ignore	I
,	B
@	B
dl	I
int	B
,	I
@	B
a1	I
int	B
,	I
@	B
a2	I
int	B
,	I
@	B
z1	I
int	B
,	I
@	B
z2	I
int	B
,	I
@	B
n1	I
int	B
,	I
@	B
n2	I
int	B
,	I
@	B
c	I
,	B
@	B
a	I
smallint	B
select	B
@	B
a1	I
=	B
,	B
@	B
a2	I
=	B
,	B
@	B
z1	I
=	B
,	B
@	B
z2	I
=	B
,	B
@	B
n1	I
=	B
,	B
@	B
n2	I
=	B
set	B
@	B
ignore	I
=	B
'	B
''	I
''	I
'	I
set	B
@	B
pos	I
=	B
1	B
set	B
@	B
dl	I
=	B
set	B
@	B
lpos	I
=	B
1	B
set	B
@	B
item	I
=	B
''	B
while	B
(	B
@	I
pos	I
=	B
@	B
dl	I
)	I
begin	B
set	B
@	B
c	I
=	B
if	B
(	B
@	I
ignore	I
not	B
like	B
'	B
%	I
'	I
+	B
@	B
c	I
+	B
'	B
%	I
'	I
)	I
begin	B
set	B
@	B
a	I
=	B
if	B
and	B
(	B
@	I
a	I
=	B
@	B
z1	I
)	I
)	I
or	B
and	B
(	B
@	I
a	I
=	B
@	B
z2	I
)	I
)	I
or	B
and	B
(	B
@	I
a	I
=	B
@	B
n2	I
)	I
)	I
begin	B
set	B
@	B
item	I
=	B
@	B
item	I
+	B
@	B
c	I
end	B
else	B
if	B
(	B
@	I
item	I
''	B
)	I
begin	B
insert	B
into	B
@	B
t	I
values	B
(	B
@	I
item	I
)	I
set	B
@	B
item	I
=	B
''	B
end	B
end	B
set	B
@	B
pos	I
=	B
@	B
pos	I
+	B
1	B
end	B
if	B
(	B
@	I
item	I
''	B
)	I
begin	B
insert	B
into	B
@	B
t	I
values	B
(	B
@	I
item	I
)	I
end	B
SplitWordList	O
]	O
(	O
@	O
list	O
varchar	O
(	O
8000	O
)	O
varchar	B
(	I
50	I
)	I
identity	B
(	I
1,1	I
)	I
varchar	B
(	I
100	I
)	I
varchar	B
(	I
100	I
)	I
varchar	B
(	I
1	I
)	I
ascii	B
(	I
'a	I
'	I
)	I
ascii	B
(	I
'A	I
'	I
)	I
ascii	B
(	I
'z	I
'	I
)	I
ascii	B
(	I
'Z	I
'	I
)	I
ascii	B
(	I
'0	I
'	I
)	I
ascii	B
(	I
'9	I
'	I
)	I
datalength	B
(	I
@	I
list	I
)	I
(	O
@	O
list	O
,	O
@	O
pos	O
,	O
1	O
)	O
ascii	B
(	I
@	I
c	I
)	I
(	O
@	O
a	O
=	O
@	O
a1	O
)	O
(	O
@	O
a	O
=	O
@	O
a2	O
)	O
(	O
@	O
a	O
=	O
@	O
n1	O
)	O
Test	O
it	O
like	O
this	O
:	O
select	B
*	B
from	B
(	O
'Hello	O
John	O
Smith	O
'	O
)	O
