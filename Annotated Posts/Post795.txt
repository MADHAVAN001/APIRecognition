Try	O
this	O
:	O
CREATE	B
function	I
)	I
returns	I
@	I
t	I
table	I
(	I
Word	I
not	I
null	I
,	I
Position	I
int	I
not	I
null	I
)	I
as	O
begin	O
declare	O
@	O
pos	O
int	O
,	O
@	O
lpos	O
int	O
,	O
@	O
item	O
,	O
@	O
ignore	O
,	O
@	O
dl	O
int	O
,	O
@	O
a1	O
int	O
,	O
@	O
a2	O
int	O
,	O
@	O
z1	O
int	O
,	O
@	O
z2	O
int	O
,	O
@	O
n1	O
int	O
,	O
@	O
n2	O
int	O
,	O
@	O
c	O
,	O
@	O
a	O
smallin	O
select	O
@	O
a1	O
=	O
,	O
@	O
a2	O
=	O
,	O
@	O
z1	O
=	O
,	O
@	O
z2	O
=	O
,	O
@	O
n1	O
=	O
,	O
@	O
n2	O
=	O
set	O
@	O
ignore	O
=	O
'	O
''	O
''	O
'	O
set	O
@	O
pos	O
=	O
1	O
set	O
@	O
dl	O
=	O
set	O
@	O
lpos	O
=	O
1	O
set	O
@	O
item	O
=	O
''	O
while	O
(	O
@	O
pos	O
=	O
@	O
dl	O
)	O
begin	O
set	O
@	O
c	O
=	O
if	O
(	O
@	O
ignore	O
not	O
like	O
'	O
%	O
'	O
+	O
@	O
c	O
+	O
'	O
%	O
'	O
)	O
begin	O
set	O
@	O
a	O
=	O
if	O
and	O
(	O
@	O
a	O
=	O
@	O
z1	O
)	O
)	O
or	O
and	O
(	O
@	O
a	O
=	O
@	O
z2	O
)	O
)	O
or	O
and	O
(	O
@	O
a	O
=	O
@	O
n2	O
)	O
)	O
begin	O
set	O
@	O
item	O
=	O
@	O
item	O
+	O
@	O
c	O
end	O
else	O
if	O
(	O
@	O
item	O
''	O
)	O
begin	O
insert	O
into	O
@	O
t	O
values	O
(	O
@	O
item	O
)	O
set	O
@	O
item	O
=	O
''	O
end	O
end	O
set	O
@	O
pos	O
=	O
@	O
pos	O
+	O
1	O
end	O
if	O
(	O
@	O
item	O
''	O
)	O
begin	O
insert	O
into	O
@	O
t	O
values	O
(	O
@	O
item	O
)	O
end	O
SplitWordList	O
]	O
(	O
@	O
list	O
varchar	O
(	O
8000	O
)	O
varchar	O
(	O
50	O
)	O
identity	O
(	O
1,1	O
)	O
varchar	O
(	O
100	O
)	O
varchar	O
(	O
100	O
)	O
varchar	O
(	O
1	O
)	O
ascii	O
(	O
'a	O
'	O
)	O
ascii	B
(	I
'A	I
'	I
)	I
ascii	B
(	I
'z	I
'	I
)	I
ascii	B
(	I
'Z	I
'	I
)	I
ascii	B
(	I
'0	I
'	I
)	I
ascii	B
(	I
'9	I
'	I
)	I
datalength	B
(	I
@	I
list	I
)	I
(	O
@	O
list	O
,	O
@	O
pos	O
,	O
1	O
)	O
ascii	B
(	I
@	I
c	I
)	I
(	O
@	O
a	O
=	O
@	O
a1	O
)	O
(	O
@	O
a	O
=	O
@	O
a2	O
)	O
(	O
@	O
a	O
=	O
@	O
n1	O
)	O
Test	O
it	O
like	O
this	O
:	O
select	O
*	O
from	O
(	O
'Hello	O
John	O
Smith	O
'	O
)	O
