Brian	O
gives	O
a	O
nice	O
solution	O
for	O
converting	O
it	O
to	O
a	O
strongly	O
typed	O
collection	O
.	O
Most	O
of	O
the	O
CSV	O
parsing	O
methods	O
given	O
do	O
n't	O
take	O
into	O
account	O
escaping	O
fields	O
or	O
some	O
of	O
the	O
other	O
subtleties	O
of	O
CSV	O
files	O
(	O
like	O
trimming	O
fields	O
)	O
.	O
Here	O
is	O
the	O
code	O
I	O
personally	O
use	O
.	O
It	O
's	O
a	O
bit	O
rough	O
around	O
the	O
edges	O
and	O
has	O
pretty	O
much	O
no	O
error	O
reporting	O
.	O
public	O
static	B-API
IListIListstring	O
{	O
IListIListstring	O
records	O
=	O
new	O
;	O
StringReader	B-API
stringReader	I-API
=	I-API
new	I-API
;	O
bool	B-API
inQoutedString	I-API
=	I-API
false	I-API
;	I-API
IListstring	B-API
record	B-API
=	B-API
new	I-API
;	O
StringBuilder	B-API
fieldBuilder	I-API
=	I-API
new	I-API
;	O
while	O
!	O
=	O
-1	O
)	O
{	O
char	O
readChar	O
=	O
;	O
if	O
(	O
readChar	O
==	O
'\n	O
'	O
||	O
(	O
readChar	O
==	O
'\r	O
'	O
==	O
'\n	O
'	O
)	O
)	O
{	O
//	O
If	O
it	O
's	O
a	O
\r\n	O
combo	O
consume	O
the	O
\n	O
part	O
and	O
throw	O
it	O
away	O
.	O
if	O
(	O
readChar	O
==	O
'\r	O
'	O
)	O
{	O
;	O
}	O
if	O
(	O
inQoutedString	O
)	O
{	O
if	O
(	O
readChar	O
==	O
'\r	O
'	O
)	O
{	O
;	O
}	O
;	O
}	O
else	O
{	O
)	O
;	O
fieldBuilder	B-API
=	I-API
new	I-API
;	O
;	O
record	O
=	O
new	O
;	O
inQoutedString	O
=	O
false	O
;	O
}	O
}	O
else	O
if	O
(	O
fieldBuilder.Length	O
==	O
0	O
!	O
inQoutedString	O
)	O
{	O
if	O
)	O
{	O
//	O
Ignore	O
leading	O
whitespaCe	O
}	O
else	O
if	O
(	O
readChar	O
==	O
'	O
''	O
'	O
)	O
{	O
inQoutedString	O
=	O
true	O
;	O
}	O
else	O
if	O
(	O
readChar	O
==	O
'	O
,	O
'	O
)	O
{	O
)	O
;	O
fieldBuilder	O
=	O
new	O
;	O
}	O
else	O
{	O
;	O
}	O
}	O
else	O
if	O
(	O
readChaO	O
==	O
'	O
,	O
'	O
)	O
{	O
if	O
(	O
inQoutedString	O
)	O
{	O
;	O
}	O
else	O
{	O
)	O
;	O
fieldBuilder	O
=	O
new	O
;	O
}	O
}	O
else	O
if	O
(	O
readChar	O
==	O
'	O
''	O
'	O
)	O
{	O
if	O
(	O
inQoutedString	O
)	O
{	O
if	O
==	O
'	O
''	O
'	O
)	O
{	O
;	O
;	O
}	O
else	O
{	O
inQoutedString	O
=	O
false	O
;	O
}	O
}	O
else	O
{	O
;	O
}	O
}	O
else	O
{	O
;	O
}	O
}	O
)	O
;	O
;	O
return	O
(	O
string	B-API
content	I-API
)	O
ListIListstring	B-API
(	I-API
)	I-API
StringReader	B-API
(	I-API
content	I-API
)	I-API
Liststring	B-API
(	I-API
)	I-API
StringBuilder	B-API
(	I-API
)	I-API
(	O
stringReader.Peek	B-API
(	I-API
)	I-API
(	O
char	O
)	O
stringReader.Read	B-API
(	I-API
)	I-API
stringReader.Peek	B-API
(	I-API
)	I-API
stringReader.Read	B-API
(	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
'\r	I-API
'	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
'\n	I-API
'	I-API
)	I-API
record.Add	B-API
(	I-API
fieldBuilder.ToString	B-API
(	I-API
)	I-API
.TrimEnd	I-API
(	I-API
)	I-API
StringBuilder	B-API
(	I-API
)	I-API
records.Add	O
(	O
record	O
)	O
Liststring	O
(	O
)	O
(	O
char.IsWhiteSpace	B-API
(	I-API
readChar	I-API
)	I-API
record.Add	O
(	O
fieldBuilder.ToString	B-API
(	I-API
)	I-API
.TrimEnd	I-API
(	I-API
)	I-API
StringBuilder	B-API
(	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
readChar	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
'	I-API
,	I-API
'	I-API
)	I-API
record.Add	B-API
(	I-API
fieldBuilder.ToString	I-API
(	I-API
)	I-API
.TrimEnd	I-API
(	I-API
)	I-API
StringBuilder	B-API
(	I-API
)	I-API
(	O
stringReader.Peek	B-API
(	I-API
)	I-API
stringReader.Read	B-API
(	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
'	I-API
''	I-API
'	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
readChar	I-API
)	I-API
fieldBuilder.Append	B-API
(	I-API
readChar	I-API
)	I-API
record.Add	B-API
(	I-API
fieldBuilder.ToString	B-API
(	I-API
)	I-API
.TrimEnd	I-API
(	I-API
)	I-API
records.Add	B-API
(	I-API
record	I-API
)	I-API
Note	O
that	O
this	O
does	O
n't	O
handle	O
the	O
edge	O
case	O
of	O
fields	O
not	O
being	O
deliminated	O
by	O
double	O
quotes	O
,	O
but	O
meerley	O
having	O
a	O
quoted	O
string	O
inside	O
of	O
it	O
.	O
See	O
this	O
post	O
for	O
a	O
bit	O
of	O
a	O
better	O
expanation	O
as	O
well	O
as	O
some	O
links	O
to	O
some	O
proper	O
libraries	O
.	O
