I	O
thought	O
I	O
'd	O
give	O
this	O
a	O
shot	O
using	O
classes	O
and	O
polymorphism	O
.	O
I	O
had	O
a	O
previous	O
iteration	O
which	O
used	O
sub-classing	O
which	O
ended	O
up	O
having	O
way	O
too	O
much	O
overhead	O
.	O
I	O
've	O
switched	O
to	O
a	O
more	O
flexible	O
delegate	O
/	O
public	O
property	O
object	O
model	O
which	O
is	O
significantly	O
better	O
.	O
My	O
code	O
is	O
very	O
slightly	O
more	O
accurate	O
,	O
I	O
wish	O
I	O
could	O
come	O
up	O
with	O
a	O
better	O
way	O
to	O
generate	O
``	O
months	O
ago	O
''	O
that	O
did	O
n't	O
seem	O
too	O
over-engineered	O
.	O
I	O
think	O
I	O
'd	O
still	O
stick	O
with	O
Jeff	O
's	O
if-then	O
cascade	O
because	O
it	O
's	O
less	O
code	O
and	O
it	O
's	O
simpler	O
(	O
it	O
's	O
definitely	O
easier	O
to	O
ensure	O
it	O
'll	O
work	O
as	O
expected	O
)	O
.	O
For	O
the	O
below	O
code	O
PrintRelativeTime.GetRelativeTimeMessage	B-API
(	I-API
TimeSpan	I-API
ago	I-API
)	I-API
returns	O
the	O
relative	O
time	O
message	O
(	O
e.g	O
.	O
``	O
yesterday	O
''	O
)	O
.	O
public	B-API
class	I-API
RelativeTimeRange	I-API
:	I-API
IComparable	I-API
{	O
public	O
TimeSpan	O
UpperBound	O
{	O
get	O
;	O
set	O
;	O
}	O
public	O
delegate	B-API
string	I-API
;	O
public	O
RelativeTimeTextDelegate	B-API
MessageCreator	I-API
{	O
get	O
;	O
set	O
;	O
}	O
public	O
int	O
{	O
if	O
)	O
{	O
return	O
1	O
;	O
}	O
//	O
note	O
that	O
this	O
sorts	O
in	O
reverse	O
order	O
to	O
the	O
way	O
you	O
'd	O
expect	O
,	O
//	O
this	O
saves	O
having	O
to	O
reverse	O
a	O
list	O
later	O
return	O
(	O
obj	O
as	O
;	O
}	O
}	O
public	O
class	B-API
PrintRelativeTime	I-API
{	O
private	O
static	B-API
ListRelativeTimeRange	I-API
timeRanges	I-API
;	O
static	O
{	O
timeRanges	O
=	O
new	O
ListRelativeTimeRange	B-API
{	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
second	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Seconds	B-API
+	O
``	O
seconds	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
minute	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Minutes	O
+	O
``	O
minutes	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
hour	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Hours	O
+	O
``	O
hours	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
yesterday	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
)	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Days	O
+	O
``	O
days	O
ago	O
''	O
;	O
}	O
}	O
,	I-API
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
)	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
month	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
)	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
+	O
``	O
months	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
)	O
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
year	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B-API
{	O
UpperBound	B-API
=	O
TimeSpan.MaxValue	B-API
,	O
MessageCreator	B-API
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
+	O
``	O
years	O
ago	O
''	O
;	O
}	O
}	O
}	O
;	O
;	O
}	O
public	O
static	B-API
string	I-API
{	O
RelativeTimeRange	B-API
postRelativeDateRange	O
=	O
timeRanges	B-API
[	I-API
0	I-API
]	I-API
;	O
foreach	B-API
(	I-API
var	I-API
timeRange	I-API
in	I-API
timeRanges	I-API
)	I-API
{	O
if	O
=	O
0	O
)	O
{	O
postRelativeDateRange	O
=	O
timeRange	O
;	O
}	O
}	O
return	O
;	O
(	O
TimeSpan	O
timeDelta	B-API
)	I-API
(	I-API
object	O
obj	O
)	O
!	O
(	O
obj	O
is	O
RelativeTimeRange	B-API
)	O
RelativeTimeRange	B-API
)	O
.UpperBound.CompareTo	B-API
(	I-API
UpperBound	I-API
)	I-API
PrintRelativeTime	B-API
(	I-API
)	I-API
TimeSpan.FromSeconds	B-API
(	I-API
1	I-API
)	I-API
TimeSpan.FromSeconds	B-API
(	I-API
60	I-API
)	I-API
TimeSpan.FromMinutes	B-API
(	I-API
2	I-API
)	I-API
TimeSpan.FromMinutes	B-API
(	I-API
60	I-API
)	I-API
TimeSpan.FromHours	B-API
(	I-API
2	I-API
)	I-API
TimeSpan.FromHours	B-API
(	I-API
24	I-API
)	I-API
TimeSpan.FromDays	B-API
(	I-API
2	I-API
)	I-API
DateTime.Now.Subtract	B-API
(	O
DateTime.Now.AddMonths	I-API
(	I-API
-1	I-API
)	I-API
DateTime.Now.Subtract	B-API
(	O
DateTime.Now.AddMonths	I-API
(	I-API
-2	I-API
)	I-API
DateTime.Now.Subtract	B-API
(	O
DateTime.Now.AddYears	I-API
(	I-API
-1	I-API
)	I-API
int	O
)	O
Math.Floor	B-API
(	I-API
delta.TotalDays	I-API
/	I-API
30	I-API
)	I-API
DateTime.Now.Subtract	B-API
(	O
DateTime.Now.AddYears	I-API
(	I-API
-2	I-API
)	I-API
int	O
)	O
Math.Floor	B-API
(	I-API
delta.TotalDays	I-API
/	I-API
365.24D	I-API
)	I-API
timeRanges.Sort	B-API
(	I-API
)	I-API
(	O
TimeSpan	O
ago	O
)	O
(	O
ago.CompareTo	B-API
(	I-API
timeRange.UpperBound	I-API
)	I-API
postRelativeDateRange.MessageCreator	B-API
(	I-API
ago	I-API
)	I-API
