I	O
want	O
to	O
print	O
HTML	O
from	O
a	O
C	O
#	O
web	O
service	O
.	O
The	O
Web	O
Browser	O
control	O
is	O
overkill	O
,	O
and	O
does	O
not	O
function	O
well	O
in	O
a	O
service	O
environment	O
,	O
nor	O
does	O
it	O
function	O
well	O
on	O
a	O
system	O
with	O
very	O
tight	O
security	O
constraints	O
.	O
Is	O
there	O
any	O
sort	O
of	O
free	O
library	O
that	O
will	O
support	O
the	O
printing	O
of	O
a	O
basic	O
HTML	O
page	O
?	O
Here	O
is	O
the	O
code	O
I	O
have	O
so	O
far	O
,	O
which	O
does	O
not	O
run	O
properly	O
.	O
public	O
void	O
PrintThing	O
(	O
string	O
document	O
)	O
{	O
if	O
(	O
Thread.CurrentThread.GetApartmentState	O
(	O
)	O
!	O
=	O
ApartmentState.STA	O
)	O
{	O
Thread	O
thread	O
=	O
new	O
Thread	O
(	O
(	O
ThreadStart	O
)	O
delegate	O
{	O
PrintDocument	O
(	O
document	O
)	O
;	O
}	O
)	O
;	O
thread.SetApartmentState	O
(	O
ApartmentState.STA	O
)	O
;	O
thread.Start	O
(	O
)	O
;	O
}	O
else	O
{	O
PrintDocument	O
(	O
document	O
)	O
;	O
}	O
}	O
protected	O
void	O
PrintDocument	O
(	O
string	O
document	O
)	O
{	O
WebBrowser	O
browser	O
=	O
new	O
WebBrowser	O
(	O
)	O
;	O
browser.DocumentText	O
=	O
document	O
;	O
while	O
(	O
browser.ReadyState	O
!	O
=	O
WebBrowserReadyState.Complete	O
)	O
{	O
Application.DoEvents	O
(	O
)	O
;	O
}	O
browser	O
.	O
Print	B
(	I
)	I
;	O
}	O
This	O
works	O
fine	O
when	O
called	O
from	O
UI-type	O
threads	O
,	O
but	O
nothing	O
happens	O
when	O
called	O
from	O
a	O
service-type	O
thread	O
.	O
Changing	O
Print	O
(	O
)	O
to	O
ShowPrintPreviewDialog	B
(	I
)	I
yields	O
the	O
following	O
IE	O
script	O
error	O
:	O
Error	O
:	O
'dialogArguments.___IE_PrintType	O
'	O
is	O
null	O
or	O
not	O
an	O
object	O
URL	O
:	O
res	O
:	O
//ieframe.dll/preview.dlg	O
And	O
a	O
small	O
empty	O
print	O
preview	O
dialog	O
appears	O
.	O
