This	O
is	O
part	O
of	O
a	O
solution	O
I	O
use	O
on	O
a	O
local	O
intranet	O
.	O
Some	O
of	O
the	O
variables	O
you	O
will	O
have	O
to	O
collect	O
yourself	O
as	O
I	O
pull	O
them	O
from	O
a	O
database	O
but	O
you	O
may	O
pull	O
them	O
from	O
somewhere	O
else	O
.	O
The	O
only	O
extra	O
but	O
I	O
've	O
got	O
in	O
there	O
is	O
a	O
function	O
called	O
getMimeType	B
which	O
connects	O
to	O
the	O
database	O
and	O
pulls	O
back	O
the	O
correct	O
mine	O
type	O
based	O
on	O
file	O
extension	O
.	O
This	O
defaults	O
to	O
application/octet-stream	O
if	O
none	O
is	O
found	O
.	O
//	O
Clear	O
the	O
response	O
buffer	O
incase	O
there	O
is	O
anything	O
already	O
in	O
;	O
Response.Buffer	B
=	I
true	I
;	O
//	O
Read	O
the	O
original	O
file	O
from	O
diskFileStream	B
myFileStream	I
=	I
new	I
;	O
long	O
FileSize	O
=	O
myFileStream.Length	B
;	O
byte	O
[	O
]	O
Buffer	B
=	I
new	I
;	O
//	O
Tell	O
the	O
browse	O
stuff	O
about	O
the	O
)	O
;	O
Response.ContentType	B
=	O
;	O
//	O
Send	O
the	O
data	O
to	O
the	O
it.Response.Clear	B
(	I
)	I
(	O
sPath	O
,	O
FileMode.Open	B
)	O
[	O
(	O
int	O
)	O
FileSize	O
]	O
;	O
myFileStream.Read	B
(	I
Buffer	I
,	I
0	I
,	I
(	I
int	I
)	I
FileSize	I
)	I
;	O
myFileStream.Close	B
(	I
)	I
(	O
``	O
Content-Length	O
''	O
,	O
FileSize.ToString	B
(	I
)	I
;	O
Response.AddHeader	B
(	I
)	I
``	O
Content-Disposition	O
''	O
,	O
``	O
inline	O
;	O
filename=	O
''	O
+	O
sFilename.Replace	B
(	I
``	I
``	I
,	I
''	I
_	I
''	I
)	I
(	O
sExtention	O
,	O
oConnection	O
)	O
browserResponse.BinaryWrite	B
(	I
Buffer	I
)	I
;	O
Response.End	B
(	I
)	I
