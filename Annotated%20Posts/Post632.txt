I	O
thought	O
I	O
'd	O
give	O
this	O
a	O
shot	O
using	O
classes	O
and	O
polymorphism	O
.	O
I	O
had	O
a	O
previous	O
iteration	O
which	O
used	O
sub-classing	O
which	O
ended	O
up	O
having	O
way	O
too	O
much	O
overhead	O
.	O
I	O
've	O
switched	O
to	O
a	O
more	O
flexible	O
delegate	O
/	O
public	O
property	O
object	O
model	O
which	O
is	O
significantly	O
better	O
.	O
My	O
code	O
is	O
very	O
slightly	O
more	O
accurate	O
,	O
I	O
wish	O
I	O
could	O
come	O
up	O
with	O
a	O
better	O
way	O
to	O
generate	O
``	O
months	O
ago	O
''	O
that	O
did	O
n't	O
seem	O
too	O
over-engineered	O
.	O
I	O
think	O
I	O
'd	O
still	O
stick	O
with	O
Jeff	O
's	O
if-then	O
cascade	O
because	O
it	O
's	O
less	O
code	O
and	O
it	O
's	O
simpler	O
(	O
it	O
's	O
definitely	O
easier	O
to	O
ensure	O
it	O
'll	O
work	O
as	O
expected	O
)	O
.	O
For	O
the	O
below	O
code	O
PrintRelativeTime.GetRelativeTimeMessage	B
(	I
TimeSpan	I
ago	I
)	I
returns	O
the	O
relative	O
time	O
message	O
(	O
e.g	O
.	O
``	O
yesterday	O
''	O
)	O
.	O
public	B
class	I
RelativeTimeRange	I
:	I
IComparable	I
{	O
public	O
TimeSpan	O
UpperBound	O
{	O
get	O
;	O
set	O
;	O
}	O
public	O
delegate	B
string	I
;	O
public	O
RelativeTimeTextDelegate	B
MessageCreator	I
{	O
get	O
;	O
set	O
;	O
}	O
public	O
int	O
{	O
if	O
)	O
{	O
return	O
1	O
;	O
}	O
//	O
note	O
that	O
this	O
sorts	O
in	O
reverse	O
order	O
to	O
the	O
way	O
you	O
'd	O
expect	O
,	O
//	O
this	O
saves	O
having	O
to	O
reverse	O
a	O
list	O
later	O
return	O
(	O
obj	O
as	O
;	O
}	O
}	O
public	O
class	B
PrintRelativeTime	I
{	O
private	O
static	B
ListRelativeTimeRange	I
timeRanges	I
;	O
static	O
{	O
timeRanges	O
=	O
new	O
ListRelativeTimeRange	B
{	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
second	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Seconds	B
+	O
``	O
seconds	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
minute	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Minutes	O
+	O
``	O
minutes	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
hour	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Hours	O
+	O
``	O
hours	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
yesterday	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
)	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
delta.Days	O
+	O
``	O
days	O
ago	O
''	O
;	O
}	O
}	O
,	I
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
)	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
month	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
)	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
+	O
``	O
months	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
)	O
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
``	O
one	O
year	O
ago	O
''	O
;	O
}	O
}	O
,	O
new	O
RelativeTimeRange	B
{	O
UpperBound	B
=	O
TimeSpan.MaxValue	B
,	O
MessageCreator	B
=	O
(	O
delta	O
)	O
=	O
{	O
return	O
+	O
``	O
years	O
ago	O
''	O
;	O
}	O
}	O
}	O
;	O
;	O
}	O
public	O
static	B
string	I
{	O
RelativeTimeRange	B
postRelativeDateRange	O
=	O
timeRanges	B
[	I
0	I
]	I
;	O
foreach	B
(	I
var	I
timeRange	I
in	I
timeRanges	I
)	I
{	O
if	O
=	O
0	O
)	O
{	O
postRelativeDateRange	O
=	O
timeRange	O
;	O
}	O
}	O
return	O
;	O
(	O
TimeSpan	O
timeDelta	B
)	I
(	I
object	O
obj	O
)	O
!	O
(	O
obj	O
is	O
RelativeTimeRange	B
)	O
RelativeTimeRange	B
)	O
.UpperBound.CompareTo	B
(	I
UpperBound	I
)	I
PrintRelativeTime	B
(	I
)	I
TimeSpan.FromSeconds	B
(	I
1	I
)	I
TimeSpan.FromSeconds	B
(	I
60	I
)	I
TimeSpan.FromMinutes	B
(	I
2	I
)	I
TimeSpan.FromMinutes	B
(	I
60	I
)	I
TimeSpan.FromHours	B
(	I
2	I
)	I
TimeSpan.FromHours	B
(	I
24	I
)	I
TimeSpan.FromDays	B
(	I
2	I
)	I
DateTime.Now.Subtract	B
(	O
DateTime.Now.AddMonths	I
(	I
-1	I
)	I
DateTime.Now.Subtract	B
(	O
DateTime.Now.AddMonths	I
(	I
-2	I
)	I
DateTime.Now.Subtract	B
(	O
DateTime.Now.AddYears	I
(	I
-1	I
)	I
int	O
)	O
Math.Floor	B
(	I
delta.TotalDays	I
/	I
30	I
)	I
DateTime.Now.Subtract	B
(	O
DateTime.Now.AddYears	I
(	I
-2	I
)	I
int	O
)	O
Math.Floor	B
(	I
delta.TotalDays	I
/	I
365.24D	I
)	I
timeRanges.Sort	B
(	I
)	I
(	O
TimeSpan	O
ago	O
)	O
(	O
ago.CompareTo	B
(	I
timeRange.UpperBound	I
)	I
postRelativeDateRange.MessageCreator	B
(	I
ago	I
)	I
